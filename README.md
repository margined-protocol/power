# Power

[![Continuous Integration](https://github.com/margined-protocol/power/actions/workflows/ci.yml/badge.svg)](https://github.com/margined-protocol/power/actions/workflows/ci.yml) [![codecov](https://codecov.io/github/margined-protocol/power/branch/dev/graph/badge.svg?token=6QDFXS25fj)](https://codecov.io/github/margined-protocol/power)

This repo contains Margined Power Perpetuals a decentralized power perps protocol to be deployed on [Osmosis](https://osmosis.zone/).

## Contracts

| Contract      | Reference                             | Description                                                                                                      |
| ------------- | ------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| Power         | [doc](./contracts/margined-power)     | The controller contract that enables user's to open and close power perpetual positions                          |
| Staking       | [doc](./contracts/margined-staking)   | Token holders stake `$MRG` into the staking contract which then mints `$stakedMRG` to which fees are distributed |
| Fee Collector | [doc](./contracts/margined-collector) | Fee collector accrues the fees generated by protocol to be redistributed to `$MRG` token holders                 |
| Query         | [doc](./contracts/margined_fee_pool)  | Pass-through contract to make testing easier                                                                     |

## Background

- [Power Perpetuals](https://www.paradigm.xyz/2021/08/power-perpetuals)
- [Margined Power Perpetual Docs](https://docs.margined.io/overview/power)

## Get started

### Environment Setup

#### Pre-Requisites

- Rust v1.69.\*
- `wasm32-unknown-unknown` target
- Docker

#### Instructions

- Install `rustup` via https://rustup.rs/
- Run the following:

```sh
rustup default stable
rustup target add wasm32-unknown-unknown
```

- Make sure [Docker](https://www.docker.com/) is installed

### Build

Clone this repository and build the source code:

```sh
git clone git@github.com:margined-protocol/power.git
cd power
cargo build
```

### Unit / Integration Tests

To run the tests after installing pre-requisites do the following:

Compile contracts:

```sh
./build_release.sh
```

Run the tests:

```sh
cargo test
```
